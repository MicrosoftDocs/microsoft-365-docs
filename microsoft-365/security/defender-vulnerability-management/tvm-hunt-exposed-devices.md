---
title: Hunt for exposed devices
description: Learn how Microsoft Defender Vulnerability Management can be used to help security admins, IT admins, and SecOps collaborate.
ms.service: microsoft-365-security
ms.subservice: mdvm
ms.author: siosulli
author: siosulli
ms.localizationpriority: medium
manager: dansimp
audience: ITPro
ms.collection: 
  - m365-security
  - Tier1
ms.topic: conceptual
search.appverid: met150
ms.date: 03/04/2022
---

# Hunt for exposed devices

- [Microsoft Defender Vulnerability Management](https://go.microsoft.com/fwlink/?linkid=2229011)
- [Microsoft Defender for Endpoint Plan 2](https://go.microsoft.com/fwlink/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)
- [Microsoft Defender for Servers Plan 1 & 2](/azure/defender-for-cloud/plan-defender-for-servers-select-plan) 

## Use advanced hunting to find devices with vulnerabilities

Advanced hunting is a query-based threat-hunting tool that lets you explore up to 30 days of raw data. You can proactively inspect events in your network to locate threat indicators and entities. The flexible access to data enables unconstrained hunting for both known and potential threats. to Learn more about advanced hunting, see [Advanced hunting overview](../defender-endpoint/advanced-hunting-overview.md).

> [!TIP]
> Did you know you can try all the features in Microsoft Defender Vulnerability Management for free? Find out how to [sign up for a free trial](../defender-vulnerability-management/defender-vulnerability-management-trial.md).

### Schema tables

- [DeviceTvmSoftwareInventory](../defender/advanced-hunting-devicetvmsoftwareinventory-table.md) - Inventory of software installed on devices, including their version information and end-of-support status.

- [DeviceTvmSoftwareVulnerabilities](../defender/advanced-hunting-devicetvmsoftwarevulnerabilities-table.md) - Software vulnerabilities found on devices and the list of available security updates that address each vulnerability.
- [DeviceTvmSoftwareVulnerabilitiesKB](../defender/advanced-hunting-devicetvmsoftwarevulnerabilitieskb-table.md) - Knowledge base of publicly disclosed vulnerabilities, including whether exploit code is publicly available.

- [DeviceTvmSecureConfigurationAssessment](../defender/advanced-hunting-devicetvmsecureconfigurationassessment-table.md) - Defender Vulnerability Management assessment events, indicating the status of various security configurations on devices.

- [DeviceTvmSecureConfigurationAssessmentKB](../defender/advanced-hunting-devicetvmsecureconfigurationassessmentkb-table.md) - Knowledge base of various security configurations used by Defender Vulnerability Management to assess devices; includes mappings to various standards and benchmarks
- [DeviceTvmInfoGathering](../defender/advanced-hunting-devicetvminfogathering-table.md) - Assessment events including the status of various configurations and attack surface area states of devices
- [DeviceTvmInfoGatheringKB](../defender/advanced-hunting-devicetvminfogatheringkb-table.md) - List of various configuration and attack surface area assessments used by Defender Vulnerability Management information gathering to assess devices

## Check which devices are involved in high severity alerts

1. Go to **Hunting** \> **Advanced hunting** from the left-hand navigation pane of the Microsoft 365 Defender portal.

2. Scroll through advanced hunting schemas to familiarize yourself with the column names.

3. Enter the following queries:

    ```kusto
    // Search for devices with High active alerts or Critical CVE public exploit
    let DeviceWithHighAlerts = AlertInfo
    | where Severity == "High"
    | project Timestamp, AlertId, Title, ServiceSource, Severity
    | join kind=inner (AlertEvidence | where EntityType == "Machine" | project AlertId, DeviceId, DeviceName) on AlertId
    | summarize HighSevAlerts = dcount(AlertId) by DeviceId;
    let DeviceWithCriticalCve = DeviceTvmSoftwareVulnerabilities
    | join kind=inner(DeviceTvmSoftwareVulnerabilitiesKB) on CveId
    | where IsExploitAvailable == 1 and CvssScore >= 7
    | summarize NumOfVulnerabilities=dcount(CveId),
    DeviceName=any(DeviceName) by DeviceId;
    DeviceWithCriticalCve
    | join kind=inner DeviceWithHighAlerts on DeviceId
    | project DeviceId, DeviceName, NumOfVulnerabilities, HighSevAlerts
    ```

## Related topics

- [Security recommendations](tvm-security-recommendation.md)
- [Configure data access for Defender Vulnerability Management roles](../defender-endpoint/user-roles.md#create-roles-and-assign-the-role-to-an-azure-active-directory-group)
- [Advanced hunting overview](/windows/security/threat-protection/microsoft-defender-atp/advanced-hunting-overview)
- [All advanced hunting tables](/microsoft-365/security/defender-endpoint/advanced-hunting-schema-reference)
